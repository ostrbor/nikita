sql_keys = ('StartDate', 'FinishDate', 'No_Disp')
sql_template = 'SELECT `calldate` AS `calldate`, `dstchannel` AS `dstchannel`, ( SELECT COUNT( `disposition` ) FROM `asteriskcdrdb`.`cdr` WHERE `calldate` >= "%(StartDate)s" AND `dstchannel` LIKE "SIP/%(No_Disp)s%%" AND `billsec` BETWEEN 40 AND 80 AND `disposition` = "ANSWERED" AND `calldate` <= "%(FinishDate)s" ) AS `answered >=40 <=80`, ( SELECT COUNT( `disposition` ) FROM `asteriskcdrdb`.`cdr` WHERE `calldate` >= "%(StartDate)s" AND `dstchannel` LIKE "SIP/%(No_Disp)s%%" AND `billsec` > 80 AND `disposition` = "ANSWERED" AND `calldate` <= "%(FinishDate)s" ) AS `answered >80`, ( SELECT COUNT( `disposition` ) FROM `asteriskcdrdb`.`cdr` WHERE `calldate` >= "%(StartDate)s" AND `dstchannel` LIKE "SIP/%(No_Disp)s%%" AND `billsec` BETWEEN 15 AND 39.9999 AND `disposition` = "ANSWERED" AND `calldate` <= "%(FinishDate)s" ) AS `answered >=15 <40`, ( SELECT COUNT( `disposition` ) FROM `asteriskcdrdb`.`cdr` WHERE `calldate` >= "%(StartDate)s" AND `dstchannel` LIKE "SIP/%(No_Disp)s%%" AND `disposition` = "NO ANSWER" AND `calldate` <= "%(FinishDate)s" ) AS "NO ANSWER", ( SELECT COUNT( `disposition` ) FROM `asteriskcdrdb`.`cdr` WHERE `calldate` >= "%(StartDate)s" AND `dstchannel` LIKE "SIP/%(No_Disp)s%%" AND `disposition` = "BUSY" AND `calldate` <= "%(FinishDate)s" ) AS "BUSY", ( SELECT COUNT( `disposition` ) FROM `asteriskcdrdb`.`cdr` WHERE `calldate` >= "%(StartDate)s" AND `dstchannel` LIKE "SIP/%(No_Disp)s%%" AND `disposition` = "FAILED" AND `calldate` <= "%(FinishDate)s" ) AS "FAILED", ( SELECT COUNT( `disposition` ) FROM `asteriskcdrdb`.`cdr` WHERE `calldate` >= "%(StartDate)s" AND `dstchannel` LIKE "SIP/%(No_Disp)s%%" AND `billsec` < 15 AND `disposition` = "ANSWERED" AND `calldate` <= "%(FinishDate)s" ) AS `answered <15` FROM `asteriskcdrdb`.`cdr` AS `cdr` WHERE `calldate` >= "%(StartDate)s" AND `dstchannel` LIKE "SIP/%(No_Disp)s%%" AND `calldate` <= "%(FinishDate)s"'
